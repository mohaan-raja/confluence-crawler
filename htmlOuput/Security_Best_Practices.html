<h1>Title: Security Best Practices</h1><p><br/></p><div class="table-wrap"><table class="relative-table confluenceTable" style="width: 100.0%;"><colgroup><col style="width: 6.6961%;"/><col style="width: 83.5909%;"/></colgroup><tbody><tr><th colspan="1" class="confluenceTh">Weakness</th><th class="confluenceTh">Recommendation</th></tr><tr><td colspan="1" class="confluenceTd">SSRF</td><td class="confluenceTd"><p>SSRF helps an attacker to send a crafted request from a vulnerable web application to access internal systems behind firewalls that are normally inaccessible to the public. In our application, we were able to do the same via <strong>HTTP request proxy</strong> to access internal servers which are hosted in AWS. We believe that most of our applications are using HTTP request proxy to check the URL or to get data from the integration / third-party application.<br/><br/></p>1. Blacklist all private IP's and loopback addresses<br/>    · <a href="http://10.0.0.0/8" class="external-link" rel="nofollow">10.0.0.0/8</a><br/>    · <a href="http://172.16.0.0/12" class="external-link" rel="nofollow">172.16.0.0/12</a><br/>    · <a href="http://192.168.0.0/16" class="external-link" rel="nofollow">192.168.0.0/16</a><br/>    · Link-local unicast: <a href="http://169.254.0.0/16" class="external-link" rel="nofollow">169.254.0.0/16</a> &amp; fe80::/10<br/>    · Loopback interface: <a href="http://127.0.0.0/8" class="external-link" rel="nofollow">127.0.0.0/8</a> &amp; ffx1::/16<br/>2. Disable protocols such as <a href="file:///" class="external-link" rel="nofollow">file:///</a>, dict://, ftp:// and gopher:// that helps attacker to access our server files (Mostly anything apart from https://).<br/>3. Disable following of HTTP redirects that are happening via HTTP request proxy.<br/><br/>Reference Tickets: <a href="https://freshworks.freshrelease.com/FS/issues/FS-5060" class="external-link" rel="nofollow">FS-5060</a> and <a href="https://freshworks.freshrelease.com/FS/issues/FSALES-3948" class="external-link" rel="nofollow">FSALES-3948</a></td></tr><tr><td colspan="1" class="confluenceTd">safe_send</td><td class="confluenceTd"><p><a href="https://ruby-doc.org/core-2.5.0/Object.html#method-i-send" class="external-link" rel="nofollow">send</a> is a ruby method that allows invoking another method by name. It is used as a common way of calling methods dynamically ( when we don't know the method name in advance )</p><p><strong>send(&quot;method_name&quot;,args)</strong></p><p><u>Vulnerable code snippet:</u></p><p>method = params [ :method ]<br/>@result = User.send(method.to_sym)</p><p>In the above snippet, the value of &quot;method&quot; parameter is controlled by the user. Direct user input must not be passed onto the send method. For eg, an attacker could invoke the 'system()' method to execute system commands.</p><p><strong>send('system','ls') -&gt; Executes 'ls' command.</strong></p><p><u>Remediation:</u></p><p>1. Whitelist the methods that you are going to call using the send method. </p><p>2. Freshdesk product team has coded &quot;<strong>safe_send</strong>&quot; method which overrides the send method. safe_send blacklists some of the riskier methods such as system, eval, instance_eval, send, _send_, public_send, exit etc.., We could use <strong>safe_send </strong>instead of send. </p><p>safe_send code information: <a href="https://github.com/freshdesk/helpkit/blob/dfacb5bda7b67bf6452a27c394b7ebf7de0a60bd/lib/helpdesk/initializers/core_ext/object.rb" class="external-link" rel="nofollow">https://github.com/freshdesk/helpkit/blob/dfacb5bda7b67bf6452a27c394b7ebf7de0a60bd/lib/helpdesk/initializers/core_ext/object.rb</a></p><p>3. Brakeman also flags this issue as &quot;<strong><a href="https://brakemanscanner.org/docs/warning_types/dangerous_send/" class="external-link" rel="nofollow">Dangerous send</a></strong>&quot;. We could check for &quot;Dangerous send&quot; warning in brakeman results. </p><p><a href="https://docs.google.com/presentation/d/13CnQy0xjb5cb3f5aAL7BpH0anxh0BwDoSxUs_GytiJk/edit?usp=sharing" class="external-link" rel="nofollow">https://docs.google.com/presentation/d/13CnQy0xjb5cb3f5aAL7BpH0anxh0BwDoSxUs_GytiJk/edit?usp=sharing</a></p></td></tr><tr><td colspan="1" class="confluenceTd">SSO</td><td class="confluenceTd"><p><span style="color: rgb(0,0,0);">Protecting Customer data is the top priority of Freshworks. Whenever a customer faces any issue in our products, a ticket is raised to our support team. In order to debug the issue in depth, our agents/engineers might require access to the customer’s portal.</span><span style="color: rgb(0,0,0);"><br class="m_2315276454584902554gmail-kix-line-break"/></span><span style="color: rgb(0,0,0);"><br class="m_2315276454584902554gmail-kix-line-break"/></span><span style="color: rgb(0,0,0);">Why Access is required :</span><span style="color: rgb(0,0,0);"> </span><span style="color: rgb(0,0,0);"><br class="m_2315276454584902554gmail-kix-line-break"/></span><span style="color: rgb(0,0,0);"> </span><span style="color: rgb(0,0,0);">To validate, debug or confirm the occurrence of the issue reported by the customer.</span></p><p><span style="color: rgb(0,0,0);">How do we get access : </span></p><ol><li style="list-style-type: decimal;"><p><span>Ask the customer to add our agent(s) as an occasional agent(s) and login with a day pass.</span></p></li><li style="list-style-type: decimal;"><p><span>Single Sign-on is used under unavoidable situations. </span></p></li></ol><span style="color: rgb(34,34,34);"><br/></span><p><span style="color: rgb(0,0,0);">Although the intent is to debug the issue, viewing customer’s data should happen </span><span style="color: rgb(0,0,0);">ONLY</span><span style="color: rgb(0,0,0);"> with their consent. </span><span style="color: rgb(0,0,0);">Regardless of the fact that only a customer can create an occasional agent for us, an intimation must be given to the customer every time we need to log into their portal.</span></p><p><span style="color: rgb(0,0,0);">Process change recommendation :</span></p><ul><li style="list-style-type: disc;"><p><span>The support agent addressing the issue should intimate the customer every time a login is required to the portal. As a temporary remediation, a ticket conversation which illustrates the ‘Purpose of login’ should be sent to the customer everytime a login is to be made.  </span></p></li><li style="list-style-type: disc;"><p><span>Reusing the same password for every </span><span style="color: rgb(51,51,51);">occasional</span><span> agent, across portals is discouraged.</span></p></li><li style="list-style-type: disc;"><p><span>SSO must be enabled or disabled only by the customer, or if any configuration help on SSO is required, it must be altered </span><span>ONLY</span><span> after getting a consent for the same.</span></p></li></ul><span style="color: rgb(34,34,34);"><br/></span><p><span style="color: rgb(0,0,0);">Product change recommendation :</span></p><ul><li style="list-style-type: disc;"><p><span>Customer controlling the occasional agent's expiry :</span><span> In this case, a customer can create an occasional agent with an expiry time (24 hours or 48 hours or 1 week), post which a login cannot be made and any existing session will timeout. Additionally, an email can be sent to the customer every time a login is made within the timeframe.</span></p></li><li style="list-style-type: disc;"><p><span>In case of Single Sign on</span><span>: The url generated must be usable only once and must be valid only for ±30 seconds.</span></p></li><li style="list-style-type: disc;"><p><span>Whenever customer disables SSO, the shared secret must be regenerated. </span></p></li><li style="list-style-type: disc;"><p><span>As a long term solution, SSO should be managed by a central framework across all products, in our case, FreshID. </span></p></li></ul></td></tr><tr><td colspan="1" class="confluenceTd">AWS Config</td><td class="confluenceTd"><div class="content-wrapper"><p style="text-align: justify;"><span style="color: rgb(34,34,34);">AWS Config is a service that enables us to audit and evaluate the configurations of the AWS resources.  This service uses AWS CloudTrail data for operating and producing results.</span></p><p style="text-align: justify;"><strong><span style="color: rgb(34,34,34);">Primary Features of AWS Config:</span></strong></p><ol><li style="list-style-type: decimal;"><p style="text-align: justify;"><span>Maintains the inventory of supported AWS resources. (Eg., List of security groups present within a region can be viewed). </span></p></li></ol><p style="margin-left: 36.0pt;text-align: justify;"><span style="color: rgb(34,34,34);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource" draggable="false" height="300" width="547" src="data:text/html; charset=UTF-8;base64,PCFET0NUWVBFIGh0bWw+PGh0bWwgbGFuZz1lbj48bWV0YSBjaGFyc2V0PXV0Zi04PjxtZXRhIG5hbWU9dmlld3BvcnQgY29udGVudD0iaW5pdGlhbC1zY2FsZT0xLCBtaW5pbXVtLXNjYWxlPTEsIHdpZHRoPWRldmljZS13aWR0aCI+PHRpdGxlPkVycm9yIDQwMyAoRm9yYmlkZGVuKSEhMTwvdGl0bGU+PHN0eWxlPip7bWFyZ2luOjA7cGFkZGluZzowfWh0bWwsY29kZXtmb250OjE1cHgvMjJweCBhcmlhbCxzYW5zLXNlcmlmfWh0bWx7YmFja2dyb3VuZDojZmZmO2NvbG9yOiMyMjI7cGFkZGluZzoxNXB4fWJvZHl7bWFyZ2luOjclIGF1dG8gMDttYXgtd2lkdGg6MzkwcHg7bWluLWhlaWdodDoxODBweDtwYWRkaW5nOjMwcHggMCAxNXB4fSogPiBib2R5e2JhY2tncm91bmQ6dXJsKC8vd3d3Lmdvb2dsZS5jb20vaW1hZ2VzL2Vycm9ycy9yb2JvdC5wbmcpIDEwMCUgNXB4IG5vLXJlcGVhdDtwYWRkaW5nLXJpZ2h0OjIwNXB4fXB7bWFyZ2luOjExcHggMCAyMnB4O292ZXJmbG93OmhpZGRlbn1pbnN7Y29sb3I6Izc3Nzt0ZXh0LWRlY29yYXRpb246bm9uZX1hIGltZ3tib3JkZXI6MH1AbWVkaWEgc2NyZWVuIGFuZCAobWF4LXdpZHRoOjc3MnB4KXtib2R5e2JhY2tncm91bmQ6bm9uZTttYXJnaW4tdG9wOjA7bWF4LXdpZHRoOm5vbmU7cGFkZGluZy1yaWdodDowfX0jbG9nb3tiYWNrZ3JvdW5kOnVybCgvL3d3dy5nb29nbGUuY29tL2ltYWdlcy9icmFuZGluZy9nb29nbGVsb2dvLzF4L2dvb2dsZWxvZ29fY29sb3JfMTUweDU0ZHAucG5nKSBuby1yZXBlYXQ7bWFyZ2luLWxlZnQ6LTVweH1AbWVkaWEgb25seSBzY3JlZW4gYW5kIChtaW4tcmVzb2x1dGlvbjoxOTJkcGkpeyNsb2dve2JhY2tncm91bmQ6dXJsKC8vd3d3Lmdvb2dsZS5jb20vaW1hZ2VzL2JyYW5kaW5nL2dvb2dsZWxvZ28vMngvZ29vZ2xlbG9nb19jb2xvcl8xNTB4NTRkcC5wbmcpIG5vLXJlcGVhdCAwJSAwJS8xMDAlIDEwMCU7LW1vei1ib3JkZXItaW1hZ2U6dXJsKC8vd3d3Lmdvb2dsZS5jb20vaW1hZ2VzL2JyYW5kaW5nL2dvb2dsZWxvZ28vMngvZ29vZ2xlbG9nb19jb2xvcl8xNTB4NTRkcC5wbmcpIDB9fUBtZWRpYSBvbmx5IHNjcmVlbiBhbmQgKC13ZWJraXQtbWluLWRldmljZS1waXhlbC1yYXRpbzoyKXsjbG9nb3tiYWNrZ3JvdW5kOnVybCgvL3d3dy5nb29nbGUuY29tL2ltYWdlcy9icmFuZGluZy9nb29nbGVsb2dvLzJ4L2dvb2dsZWxvZ29fY29sb3JfMTUweDU0ZHAucG5nKSBuby1yZXBlYXQ7LXdlYmtpdC1iYWNrZ3JvdW5kLXNpemU6MTAwJSAxMDAlfX0jbG9nb3tkaXNwbGF5OmlubGluZS1ibG9jaztoZWlnaHQ6NTRweDt3aWR0aDoxNTBweH08L3N0eWxlPjxhIGhyZWY9Ly93d3cuZ29vZ2xlLmNvbS8+PHNwYW4gaWQ9bG9nbyBhcmlhLWxhYmVsPUdvb2dsZT48L3NwYW4+PC9hPjxwPjxiPjQwMy48L2I+IDxpbnM+VGhhdOKAmXMgYW4gZXJyb3IuPC9pbnM+PHA+WW91ciBjbGllbnQgZG9lcyBub3QgaGF2ZSBwZXJtaXNzaW9uIHRvIGdldCBVUkwgPGNvZGU+L016ZEFkMnFraUdvM3FwRmREWDQyMFJUbGtidEJfNUdXLUJWMTA4a0lrN3k0YmN0TkY5dlp5V2ZKOF9VUjhjdFdRMW9zMUt6aExTbDhUS3ZVNG1nUFU2UUtKN01Jd0xqTXVFRUxHNHF6eFJZUDR6NUpPb3FHQWMtMmRaSTBUTlVSb2ZIeGVuOTU8L2NvZGU+IGZyb20gdGhpcyBzZXJ2ZXIuICAoQ2xpZW50IElQIGFkZHJlc3M6IDEzLjIzMy41Mi45OCk8YnI+PGJyPgpBQ0wgRGVuaWVkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgPGlucz5UaGF04oCZcyBhbGwgd2Uga25vdy48L2lucz4=" data-image-src="https://lh3.googleusercontent.com/MzdAd2qkiGo3qpFdDX420RTlkbtB_5GW-BV108kIk7y4bctNF9vZyWfJ8_UR8ctWQ1os1KzhLSl8TKvU4mgPU6QKJ7MIwLjMuEELG4qzxRYP4z5JOoqGAc-2dZI0TNURofHxen95"></span></span></p><p style="text-align: justify;"><span>2. Keeps track of relationship between a resource to other AWS resources (Eg., Security group associated to network interface, EC2 instance and the particular VPC can be seen)</span></p><span><br/></span><p style="text-align: justify;"><span style="color: rgb(34,34,34);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource" draggable="false" height="139" width="555" src="data:text/html; charset=UTF-8;base64,PCFET0NUWVBFIGh0bWw+PGh0bWwgbGFuZz1lbj48bWV0YSBjaGFyc2V0PXV0Zi04PjxtZXRhIG5hbWU9dmlld3BvcnQgY29udGVudD0iaW5pdGlhbC1zY2FsZT0xLCBtaW5pbXVtLXNjYWxlPTEsIHdpZHRoPWRldmljZS13aWR0aCI+PHRpdGxlPkVycm9yIDQwMyAoRm9yYmlkZGVuKSEhMTwvdGl0bGU+PHN0eWxlPip7bWFyZ2luOjA7cGFkZGluZzowfWh0bWwsY29kZXtmb250OjE1cHgvMjJweCBhcmlhbCxzYW5zLXNlcmlmfWh0bWx7YmFja2dyb3VuZDojZmZmO2NvbG9yOiMyMjI7cGFkZGluZzoxNXB4fWJvZHl7bWFyZ2luOjclIGF1dG8gMDttYXgtd2lkdGg6MzkwcHg7bWluLWhlaWdodDoxODBweDtwYWRkaW5nOjMwcHggMCAxNXB4fSogPiBib2R5e2JhY2tncm91bmQ6dXJsKC8vd3d3Lmdvb2dsZS5jb20vaW1hZ2VzL2Vycm9ycy9yb2JvdC5wbmcpIDEwMCUgNXB4IG5vLXJlcGVhdDtwYWRkaW5nLXJpZ2h0OjIwNXB4fXB7bWFyZ2luOjExcHggMCAyMnB4O292ZXJmbG93OmhpZGRlbn1pbnN7Y29sb3I6Izc3Nzt0ZXh0LWRlY29yYXRpb246bm9uZX1hIGltZ3tib3JkZXI6MH1AbWVkaWEgc2NyZWVuIGFuZCAobWF4LXdpZHRoOjc3MnB4KXtib2R5e2JhY2tncm91bmQ6bm9uZTttYXJnaW4tdG9wOjA7bWF4LXdpZHRoOm5vbmU7cGFkZGluZy1yaWdodDowfX0jbG9nb3tiYWNrZ3JvdW5kOnVybCgvL3d3dy5nb29nbGUuY29tL2ltYWdlcy9icmFuZGluZy9nb29nbGVsb2dvLzF4L2dvb2dsZWxvZ29fY29sb3JfMTUweDU0ZHAucG5nKSBuby1yZXBlYXQ7bWFyZ2luLWxlZnQ6LTVweH1AbWVkaWEgb25seSBzY3JlZW4gYW5kIChtaW4tcmVzb2x1dGlvbjoxOTJkcGkpeyNsb2dve2JhY2tncm91bmQ6dXJsKC8vd3d3Lmdvb2dsZS5jb20vaW1hZ2VzL2JyYW5kaW5nL2dvb2dsZWxvZ28vMngvZ29vZ2xlbG9nb19jb2xvcl8xNTB4NTRkcC5wbmcpIG5vLXJlcGVhdCAwJSAwJS8xMDAlIDEwMCU7LW1vei1ib3JkZXItaW1hZ2U6dXJsKC8vd3d3Lmdvb2dsZS5jb20vaW1hZ2VzL2JyYW5kaW5nL2dvb2dsZWxvZ28vMngvZ29vZ2xlbG9nb19jb2xvcl8xNTB4NTRkcC5wbmcpIDB9fUBtZWRpYSBvbmx5IHNjcmVlbiBhbmQgKC13ZWJraXQtbWluLWRldmljZS1waXhlbC1yYXRpbzoyKXsjbG9nb3tiYWNrZ3JvdW5kOnVybCgvL3d3dy5nb29nbGUuY29tL2ltYWdlcy9icmFuZGluZy9nb29nbGVsb2dvLzJ4L2dvb2dsZWxvZ29fY29sb3JfMTUweDU0ZHAucG5nKSBuby1yZXBlYXQ7LXdlYmtpdC1iYWNrZ3JvdW5kLXNpemU6MTAwJSAxMDAlfX0jbG9nb3tkaXNwbGF5OmlubGluZS1ibG9jaztoZWlnaHQ6NTRweDt3aWR0aDoxNTBweH08L3N0eWxlPjxhIGhyZWY9Ly93d3cuZ29vZ2xlLmNvbS8+PHNwYW4gaWQ9bG9nbyBhcmlhLWxhYmVsPUdvb2dsZT48L3NwYW4+PC9hPjxwPjxiPjQwMy48L2I+IDxpbnM+VGhhdOKAmXMgYW4gZXJyb3IuPC9pbnM+PHA+WW91ciBjbGllbnQgZG9lcyBub3QgaGF2ZSBwZXJtaXNzaW9uIHRvIGdldCBVUkwgPGNvZGU+L1BhYnZCMlktV0dHUUNVMFBUcjZRME9TMnFNTEFlRHhENVpCSWxIYlZncHBRNUdsTzJXYTZ2QjVSbEVqcUhJY05ha09oUXdnek9ueWc3MUF4SlktT2dTMm1tZk9wSkM5MGVPSTlVUkw5RWFxUGhISGNYM1VLSkNsbUUxRU9PUEVna1REYW1kcF88L2NvZGU+IGZyb20gdGhpcyBzZXJ2ZXIuICAoQ2xpZW50IElQIGFkZHJlc3M6IDEzLjIzMy41Mi45OCk8YnI+PGJyPgpBQ0wgRGVuaWVkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgPGlucz5UaGF04oCZcyBhbGwgd2Uga25vdy48L2lucz4=" data-image-src="https://lh5.googleusercontent.com/PabvB2Y-WGGQCU0PTr6Q0OS2qMLAeDxD5ZBIlHbVgppQ5GlO2Wa6vB5RlEjqHIcNakOhQwgzOnyg71AxJY-OgS2mmfOpJC90eOI9URL9EaqPhHHcX3UKJClmE1EOOPEgkTDamdp_"></span></span></p><p style="text-align: justify;"><span>3. Highlights the changes made to the resources (Infrastructure Changes), over a period of time.</span></p><p style="margin-left: 36.0pt;text-align: justify;"><span style="color: rgb(34,34,34);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource" draggable="false" height="335" width="541" src="undefined" data-image-src="https://lh6.googleusercontent.com/_rQn3lzxR0t6wsgjJtZ9WGMy2YXBPryy8vhUzrnwH1jpbkFaif02806_546gd3EZtqeZXkwNu31ipJUTGS8xHelgCNty8UKbm1N12GsQ9mIUkQcLpqywhG0ZRXCtQC8lhr_xrzNe"></span></span></p><p style="text-align: justify;"><span>4. Project the timeline occurred in past for an AWS resource with exact date and time.</span></p><span><br/></span><p style="margin-left: 36.0pt;text-align: justify;"><span style="color: rgb(34,34,34);"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource" draggable="false" height="109" width="557" src="data:text/html; charset=UTF-8;base64,PCFET0NUWVBFIGh0bWw+PGh0bWwgbGFuZz1lbj48bWV0YSBjaGFyc2V0PXV0Zi04PjxtZXRhIG5hbWU9dmlld3BvcnQgY29udGVudD0iaW5pdGlhbC1zY2FsZT0xLCBtaW5pbXVtLXNjYWxlPTEsIHdpZHRoPWRldmljZS13aWR0aCI+PHRpdGxlPkVycm9yIDQwMyAoRm9yYmlkZGVuKSEhMTwvdGl0bGU+PHN0eWxlPip7bWFyZ2luOjA7cGFkZGluZzowfWh0bWwsY29kZXtmb250OjE1cHgvMjJweCBhcmlhbCxzYW5zLXNlcmlmfWh0bWx7YmFja2dyb3VuZDojZmZmO2NvbG9yOiMyMjI7cGFkZGluZzoxNXB4fWJvZHl7bWFyZ2luOjclIGF1dG8gMDttYXgtd2lkdGg6MzkwcHg7bWluLWhlaWdodDoxODBweDtwYWRkaW5nOjMwcHggMCAxNXB4fSogPiBib2R5e2JhY2tncm91bmQ6dXJsKC8vd3d3Lmdvb2dsZS5jb20vaW1hZ2VzL2Vycm9ycy9yb2JvdC5wbmcpIDEwMCUgNXB4IG5vLXJlcGVhdDtwYWRkaW5nLXJpZ2h0OjIwNXB4fXB7bWFyZ2luOjExcHggMCAyMnB4O292ZXJmbG93OmhpZGRlbn1pbnN7Y29sb3I6Izc3Nzt0ZXh0LWRlY29yYXRpb246bm9uZX1hIGltZ3tib3JkZXI6MH1AbWVkaWEgc2NyZWVuIGFuZCAobWF4LXdpZHRoOjc3MnB4KXtib2R5e2JhY2tncm91bmQ6bm9uZTttYXJnaW4tdG9wOjA7bWF4LXdpZHRoOm5vbmU7cGFkZGluZy1yaWdodDowfX0jbG9nb3tiYWNrZ3JvdW5kOnVybCgvL3d3dy5nb29nbGUuY29tL2ltYWdlcy9icmFuZGluZy9nb29nbGVsb2dvLzF4L2dvb2dsZWxvZ29fY29sb3JfMTUweDU0ZHAucG5nKSBuby1yZXBlYXQ7bWFyZ2luLWxlZnQ6LTVweH1AbWVkaWEgb25seSBzY3JlZW4gYW5kIChtaW4tcmVzb2x1dGlvbjoxOTJkcGkpeyNsb2dve2JhY2tncm91bmQ6dXJsKC8vd3d3Lmdvb2dsZS5jb20vaW1hZ2VzL2JyYW5kaW5nL2dvb2dsZWxvZ28vMngvZ29vZ2xlbG9nb19jb2xvcl8xNTB4NTRkcC5wbmcpIG5vLXJlcGVhdCAwJSAwJS8xMDAlIDEwMCU7LW1vei1ib3JkZXItaW1hZ2U6dXJsKC8vd3d3Lmdvb2dsZS5jb20vaW1hZ2VzL2JyYW5kaW5nL2dvb2dsZWxvZ28vMngvZ29vZ2xlbG9nb19jb2xvcl8xNTB4NTRkcC5wbmcpIDB9fUBtZWRpYSBvbmx5IHNjcmVlbiBhbmQgKC13ZWJraXQtbWluLWRldmljZS1waXhlbC1yYXRpbzoyKXsjbG9nb3tiYWNrZ3JvdW5kOnVybCgvL3d3dy5nb29nbGUuY29tL2ltYWdlcy9icmFuZGluZy9nb29nbGVsb2dvLzJ4L2dvb2dsZWxvZ29fY29sb3JfMTUweDU0ZHAucG5nKSBuby1yZXBlYXQ7LXdlYmtpdC1iYWNrZ3JvdW5kLXNpemU6MTAwJSAxMDAlfX0jbG9nb3tkaXNwbGF5OmlubGluZS1ibG9jaztoZWlnaHQ6NTRweDt3aWR0aDoxNTBweH08L3N0eWxlPjxhIGhyZWY9Ly93d3cuZ29vZ2xlLmNvbS8+PHNwYW4gaWQ9bG9nbyBhcmlhLWxhYmVsPUdvb2dsZT48L3NwYW4+PC9hPjxwPjxiPjQwMy48L2I+IDxpbnM+VGhhdOKAmXMgYW4gZXJyb3IuPC9pbnM+PHA+WW91ciBjbGllbnQgZG9lcyBub3QgaGF2ZSBwZXJtaXNzaW9uIHRvIGdldCBVUkwgPGNvZGU+L0F0NTZvdURVT3VWTy14bzdrelB2YWx4NUhUNDFLNTMzWm1SVDh1WnJYUHFRMDE5Z1pad1NLLUxnSnBFTFAtYWtseUdJVzNmZXh6ekJyNzM0NjF5TWpZNTlLVElkdlp1ZUsyNlNnb3p4Q0FpNUJRVTk3QUk3MXNpUS1DNThKRmFhZW9keFF4N0Q8L2NvZGU+IGZyb20gdGhpcyBzZXJ2ZXIuICAoQ2xpZW50IElQIGFkZHJlc3M6IDEzLjIzMy41Mi45OCk8YnI+PGJyPgpBQ0wgRGVuaWVkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgPGlucz5UaGF04oCZcyBhbGwgd2Uga25vdy48L2lucz4=" data-image-src="https://lh5.googleusercontent.com/At56ouDUOuVO-xo7kzPvalx5HT41K533ZmRT8uZrXPqQ019gZZwSK-LgJpELP-aklyGIW3fexzzBr73461yMjY59KTIdvZueK26SgozxCAi5BQU97AI71siQ-C58JFaaeodxQx7D"></span></span></p><p style="text-align: justify;"><strong><span style="color: rgb(34,34,34);">AWS Config Rules:</span></strong></p><p style="text-align: justify;"><span style="color: rgb(34,34,34);">AWS Config rules helps us to perform compliance auditing, monitor on change management process and to perform security analysis to look for insider threats and many. To know more about the AWS config rules, please find the link below:</span></p><p style="text-align: justify;"><a href="https://aws.amazon.com/blogs/aws/aws-config-rules-dynamic-compliance-checking-for-cloud-resources/" class="external-link" rel="nofollow"><span style="color: rgb(17,85,204);">https://aws.amazon.com/blogs/aws/aws-config-rules-dynamic-compliance-checking-for-cloud-resources/</span></a></p><p style="text-align: justify;"><span style="color: rgb(34,34,34);">To get more information on AWS config and its supported resources, config snapshots, pricing and FAQ’s please find the links below:</span></p><p style="text-align: justify;"><a href="https://aws.amazon.com/config/" class="external-link" rel="nofollow"><span style="color: rgb(17,85,204);">https://aws.amazon.com/config/</span></a></p><p style="text-align: justify;"><a href="https://aws.amazon.com/config/pricing/" class="external-link" rel="nofollow"><span style="color: rgb(17,85,204);">https://aws.amazon.com/config/pricing/</span></a></p><p style="text-align: justify;"><span style="color: rgb(17,85,204);"><a href="https://aws.amazon.com/config/faq/" class="external-link" rel="nofollow">https://aws.amazon.com/config/faq/</a></span></p></div></td></tr><tr><td colspan="1" class="confluenceTd">Security Headers</td><td colspan="1" class="confluenceTd"><p>Each header mentioned below has its own advantage, detailed information and its options are available <a href="https://docs.google.com/document/d/1Q3qs-7FgEqHmcYnArXMDFmFEu1U4K3qkKy4KArKKGxg/edit" class="external-link" rel="nofollow">here</a>.<br/> </p><ul><li><strong>X-Frame-Options</strong> - The X-Frame-Options HTTP response header can be used to instruct the browser whether to render a page in a &lt;frame&gt;, &lt;iframe&gt; or &lt;object&gt; . Web applications can use this to avoid clickjacking attacks, by ensuring that their content is not embedded into other sites.</li></ul><ul><li><strong>X-XSS-Protection</strong> - <span>The HTTP X-XSS-Protection response header is a header that instructs the browser to stops page loading when they detect reflected cross-site scripting attacks. Although these protections are largely unnecessary in modern browsers when sites implement a strong Content-Security-Policy that disables the use of inline JavaScript ('unsafe-inline'), they can still provide protection for users of older web browsers that don't yet support CSP. Their directives for X-XSS-protection are,</span></li></ul><ul><li><strong>Content Security Policy</strong> - Content Security Policy (CSP) is a header to add a layer of security that helps to detect and mitigate certain types of attacks, including Cross Site Scripting (XSS) and data injection attacks (These attacks are used for data theft from the browser, site defacement, distribution of malware) . To enable CSP, you need to configure your web server to return the Content-Security-Policy HTTP header.</li></ul><ul><li><strong>X-Content-Type-Options</strong> - The X-Content-Type-Options header is used to protect against MIME sniffing vulnerabilities. These vulnerabilities can occur when a website allows users to upload content to a website however the user disguises a particular file type as something else. This can give them the opportunity to perform cross-site scripting and compromise the website. However, this security header helps prevent these types of attacks by disabling the MIME sniffing functionality of IE and Chrome browsers so that the browser is required to use the MIME type sent via the origin server. Consider the following example of how X-Content-Type-Options works for a particular web request.<br/><br class="gmail-Apple-interchange-newline"/></li><li><strong>Strict-Transport-Security</strong> - The HTTP Strict-Transport-Security response header lets a website forces browsers that it should only be accessed using HTTPS, instead of using HTTP.</li></ul><ul><li><strong>Content-Disposition</strong> - This header can be used if you want all your attachments/user uploaded contents to the website to be downloaded when opened. This could prevent attacks like Cross-site scripting through user-uploaded contents</li></ul><ul><li><strong>Referrer-Policy</strong> - The Referrer-Policy HTTP header governs which referrer information, sent in the Referer header, should be included with requests made.This header is really useful in pages like password-rest, where the URL will contain some secret token. The secret token will be exposed to all the services loading from that page through referrer header. Adding strict Referrer-Policy for those pages will prevent leaking of sensitive tokens in URLs through referrer</li></ul><p><br/></p></td></tr><tr><td colspan="1" class="confluenceTd">TLS Encryption</td><td colspan="1" class="confluenceTd"><p><strong><span>TLS </span><span>Encryption</span><span>:</span></strong></p><p><strong>Disadvantages of TLSv1.0 and TLSv1.1:</strong></p><p>The applications using TLSv1.0 and TLSv1.1 are prone to known man-in-the-middle (&quot;MitM&quot;) attacks, including the <a href="https://bugskan.com/tutorials/owasp-tutorial-testing-for-weak-ssl-tls-cipher/" class="external-link" rel="nofollow">BEAST</a> and <a href="https://whatis.techtarget.com/definition/POODLE-attack" class="external-link" rel="nofollow">POODLE</a> attacks. </p><p><strong>Disadvantage of TLSv1.2:</strong></p><p>&quot;<a href="https://access.redhat.com/articles/2112261" class="external-link" rel="nofollow">Transcript Collision</a>&quot; is an attack identified on hash functions in cryptographic protocols such as TLS, which can force a hash-construction downgrade to MD5 and reduce expected security. These attacks rely on the use of obsolete hash constructions such as MD5 in these protocols.</p><p><strong>Latest Version:</strong></p><p><strong>TLSv1.3 - Advantage:</strong></p><ul><li>All handshake messages after the ServerHello are now encrypted.</li><li>The handshake state machine has been restructured to be more consistent and remove superfluous messages.</li><li>TLS 1.2 version negotiation verification mechanism was deprecated.</li><li>The encryption process in TLSv1.3 also starts with a client hello, but as an added advantage the client also guessed the key algorithm that the server might choose and sends a key share for that as well. The following process is same as that of TLSv1.3, however a round trip is cut short which minimises the process time.</li></ul><p><strong>Recommendation:</strong></p><p>It is recommended to upgrade to TLSv1.3 in all the products(both client side and server side) in order to avoid known vulnerabilities and secure communication between client and server.</p><p><strong>Browser Recommendation:</strong></p><ul><li>Chrome 65 and Firefox 52 currently support draft version of TLSv1.3. The original versions on both of these browsers are scheduled for release by october, 2018.</li><li>Safari supports TLS 1.3 in version 11.1 on macOS High Sierra but it’s disabled by default. This can be enabled manually.</li><li>Microsoft Edge, IE and Opera are some of the browsers which do not support TLSv1.3.</li></ul></td></tr><tr><td colspan="1" class="confluenceTd">CSRF</td><td colspan="1" class="confluenceTd"><p><strong>CSRF - Cross Site Request Forgery:</strong></p><p>CSRF attack occurs when an attacker can craft his actions on target victim in the form of specially-crafted image tags, hidden forms, and JavaScript XMLHttpRequests to trick victim to make any actions such as &quot;clicking on links&quot; and forcing him to process attacker crafted request in victim authenticated browser.</p><p>Alias:<br/>One-Click Attack<br/>Session Riding<br/>Sea Surf Attack</p><p><strong>Impact:</strong></p><p>The impact of successful CSRF attack can be vulnerable as the attacker can compromise targeted user’s active session account without knowledge of the victim.</p><p>Example: Adding/Removing Agents, Account Deactivation/Deletion,Assigning Agents to Tickets, Creating Solution Articles, Contact Conversions, Upgrading Plans/Billings etc,.</p><p><strong>Remediation / Mitigation:</strong></p><p>The general remediation for preventing CSRF attack is implementing a CSRF token in Post method/Request header for any state changing actions</p><p>Below are the list of best practices to be followed for a secure implementation:</p><p>Avoid GET method for state changing actions<br/>CSRF tokens should not be passed in GET requests - because they can be leaked at <br/>several locations like browser history, log files and network appliances. Attacker can reuse the active CSRF token to launch the successful attack.</p><p>Validate Token reuse<br/>CSRF token should be invalidated once the user active session is closed by the User and all unused/invalid tokens should not be allowed for reuse. A new random token should be generated for each user session.<br/>When you build your own CSRF token then below factors always to be present in code<br/>CSRF Token = random(active_session_id,time_stamp)</p><p>Limit expiry of tokens<br/>CSRF tokens should have limited time of expiry and it should be invalidated when the User session is closed.</p><p>Validate modified CSRF tokens:<br/>Sometimes it is possible to bypass CSRF protections by simply sending blank tokens or modifying some characters of the token to match the length of the token. Hence validation should be in place to prevent bypass.</p><p>Validate shared Tokens:<br/>There can be chances that two valid tokens can be exchanged or shared between multiple accounts and by using this case an attacker can multiple valid account to perform malicious actions.</p><p>Checking the referer header:<br/>In many cases it is best practices to check the referer / origin header to verify the request is coming from the trusted origin.<br/>But there are case where this can be bypassed by data URI - <br/>Example : data:text/html, &lt;script&gt;top.location.href='<a href="http://www.google.com/" class="external-link" rel="nofollow">http://www.google.com/';&lt;/script</a>&gt;</p><p>When this is loaded in browser it will redirect with “no referer” and origin headers as “null”. Hence it is recommend to block request if any of the headers are not present.</p><p>Using .swf files<br/>It's possible to send the &quot;X-Requested-With&quot; header with Flash, but we can't send it cross-domain due to the SOP implementation with Adobe's crossdomain.xml files. However, we can trick Flash sending the request anyway by issuing the request to a domain that does allow it, which in turn sends a HTTP 307 redirect to the resource that we want to target. Flash will send the request to the new resource before requesting crossdomain.xml on the new domain.</p><p>References: <br/><a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet" class="external-link" rel="nofollow">CSRF Cheatsheet</a></p><p><br/>Conclusion:<br/>All the above recommendations must be considered while implementing the fix for CSRF attacks in web application.</p></td></tr><tr><td colspan="1" class="confluenceTd">Github</td><td colspan="1" class="confluenceTd"><p><span style="color: rgb(34,34,34);">List of security best practices to be followed while working with GitHub:</span></p><p><strong>Refining Sensitive Data into Github:</strong></p><ul><li><span>It's always recommended to scan git commit for sensitive data such as AWS Secret Key, Hardcoded FreshID credentials, Server Credentials such as SMTP etc., before  being pushed to GitHub repositories (both Public &amp; Private) by </span><a href="https://github.com/awslabs/git-secrets" class="external-link" rel="nofollow"><span style="text-decoration: underline;">git-secrets</span></a><span> (git pre-commit hook)</span></li></ul><p style="text-align: justify;"><strong>Purging Sensitive Data from Github:</strong></p><p style="text-align: justify;"><span>If any sensitive data is missed due to human-error and made available to git repos (Both Public &amp; Private) then follow the below given steps:</span></p><ul><li><span>Invalidate and rotate leaked tokens/secrets/credentials and then create a new commit after removing the secret</span></li><li><span>Assess impact of leaked private tokens/secrets/passwords [RCA]</span></li></ul><p><strong><span>Implementing Tight Controlled Access:</span></strong></p><ul><li><span>Implement two-factor authentication for all your GitHub accounts</span></li><li><span>Never let users share GitHub accounts/passwords</span></li><li><span>Any laptops/devices with access to source code must be properly secured</span></li><li><span>Diligently revoke access from users who are no longer working with Freshworks</span></li><li><span>Manage team member’s access to data. Give contributors only access to what they need to do their work</span></li></ul><p style="text-align: justify;"><span><strong>Adding <a href="http://SECURITY.md" class="external-link" rel="nofollow">SECURITY.md</a> file:</strong> </span></p><ul><li><span><a href="http://SECURITY.md" class="external-link" rel="nofollow">SECURITY.md</a> file should portray <u>GitHub Security Best Practices</u></span><span> of Freshworks which will help developers to understand their responsibilities to prevent exposing sensitive data</span><span><br/></span><span><br/></span></li></ul><strong><span style="color: rgb(0,0,0);">GitHub Apps:</span></strong><ul><li><span>Users trying to authorise new </span><span>apps</span><span> should send approval request with error message to group mail  </span><a rel="nofollow"><span style="color: rgb(17,85,204);text-decoration: underline;">security-approvals@freshworks.com</span></a></li></ul><p><br/></p><strong><span style="color: rgb(0,0,0);">SSH keys and Personal Access Tokens:</span></strong><ul><li><span>Use deploy SSH keys per-repository basis based on the requirement in case the access to repo is required for purposes like automation, deployment, etc.</span></li><li><span style="color: rgb(0,0,0);">Access tokens should be created specifically for only one purpose and must have only relevant permissions set.</span></li><li><span style="color: rgb(0,0,0);">Access tokens should be shared with neither anyone nor anywhere</span></li><li><span style="color: rgb(0,0,0);">It is always recommended to rotate access tokens periodically to mitigate risk associated with leakage.</span></li></ul><p style="text-align: justify;"><strong>Handling committed keys:</strong></p><ul><li><span>Before importing a project into a GitHub repo, fully audit the history for sensitive data, and remove it before adding to GitHub. </span></li><li><span style="color: rgb(0,0,0);">If a credential was committed by mistake, do not attempt to create a new commit to hide it. Rather, rotate the credential/key and then create a new commit by removing it or delete the repository itself.</span></li></ul><p style="text-align: justify;"><strong>Securing the forked repositories:</strong></p><ul><li><span>We use lot of forked repositories under /freshdesk GitHub account.A forked repository will be public by default. Ideally, we should create a clone into a private repository rather than a fork.</span></li></ul><p><br/></p><span style="color: rgb(34,34,34);">For more details please refer </span><a href="https://docs.google.com/document/d/18_uxVcVzlWrlz-XXtAmg9-ossHg4RQQcCl-17jfUUyw/edit#heading=h.xd2i7e7ak7xl" class="external-link" rel="nofollow">Github Security Best Practices document here </a></td></tr></tbody></table></div>